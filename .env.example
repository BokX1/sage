# =============================================================================
# Sage Discord Bot - Environment Configuration
# =============================================================================
# IMPORTANT: Never commit this file with real values!
# Copy to .env and fill in your actual values.
# =============================================================================

# -----------------------------------------------------------------------------
# Core / Discord Configuration (REQUIRED)
# -----------------------------------------------------------------------------
NODE_ENV=development
DISCORD_TOKEN=YOUR_DISCORD_TOKEN_HERE
DISCORD_APP_ID=YOUR_APP_ID_HERE
DATABASE_URL="postgresql://postgres:password@localhost:5432/sage?schema=public"
DEV_GUILD_ID=

# -----------------------------------------------------------------------------
# LLM Configuration (Pollinations only)
# -----------------------------------------------------------------------------
LLM_PROVIDER=pollinations
POLLINATIONS_BASE_URL=https://gen.pollinations.ai/v1
POLLINATIONS_MODEL=gemini
POLLINATIONS_IMAGE_BASE_URL=https://gen.pollinations.ai
# Optional: set a global key for higher limits or leave blank and use /sage key set per server
POLLINATIONS_API_KEY=

# Profile Memory LLM Override
PROFILE_PROVIDER=
PROFILE_POLLINATIONS_MODEL=deepseek
PROFILE_UPDATE_INTERVAL=5

# Channel Summary Model
SUMMARY_MODEL=openai-large
# SUMMARY_PROVIDER is defined in config but currently unused
SUMMARY_PROVIDER=

# Formatter (reliable JSON)
FORMATTER_MODEL=qwen-coder

# -----------------------------------------------------------------------------
# Message Storage / Ingestion
# -----------------------------------------------------------------------------
LOGGING_ENABLED=true
LOGGING_MODE=all
LOGGING_ALLOWLIST_CHANNEL_IDS=
LOGGING_BLOCKLIST_CHANNEL_IDS=
MESSAGE_DB_STORAGE_ENABLED=true
PROACTIVE_POSTING_ENABLED=true
RAW_MESSAGE_TTL_DAYS=3
RING_BUFFER_MAX_MESSAGES_PER_CHANNEL=200
CONTEXT_TRANSCRIPT_MAX_MESSAGES=15
CONTEXT_TRANSCRIPT_MAX_CHARS=12000

# -----------------------------------------------------------------------------
# Channel Summaries
# -----------------------------------------------------------------------------
SUMMARY_ROLLING_WINDOW_MIN=60
SUMMARY_ROLLING_MIN_MESSAGES=20
SUMMARY_ROLLING_MIN_INTERVAL_SEC=300
SUMMARY_PROFILE_MIN_INTERVAL_SEC=21600
SUMMARY_MAX_CHARS=4000
SUMMARY_SCHED_TICK_SEC=60

# -----------------------------------------------------------------------------
# Bot Behavior
# -----------------------------------------------------------------------------
LOG_LEVEL=info
RATE_LIMIT_MAX=5
RATE_LIMIT_WINDOW_SEC=10
AUTOPILOT_MODE=manual
WAKE_WORDS=sage
# Optional: prefixes that can precede wake words (e.g., "hey sage")
# Leave empty to only trigger on wake word at start of message
WAKE_WORD_PREFIXES=
WAKEWORD_COOLDOWN_SEC=20
WAKEWORD_MAX_RESPONSES_PER_MIN_PER_CHANNEL=6

# -----------------------------------------------------------------------------
# Context Budgets
# -----------------------------------------------------------------------------
CONTEXT_MAX_INPUT_TOKENS=65536
CONTEXT_RESERVED_OUTPUT_TOKENS=8192
SYSTEM_PROMPT_MAX_TOKENS=6000
TOKEN_ESTIMATOR=heuristic
TOKEN_HEURISTIC_CHARS_PER_TOKEN=4
CONTEXT_BLOCK_MAX_TOKENS_TRANSCRIPT=8000
CONTEXT_BLOCK_MAX_TOKENS_ROLLING_SUMMARY=4800
CONTEXT_BLOCK_MAX_TOKENS_PROFILE_SUMMARY=4800
CONTEXT_BLOCK_MAX_TOKENS_MEMORY=6000
CONTEXT_BLOCK_MAX_TOKENS_REPLY_CONTEXT=3200
CONTEXT_BLOCK_MAX_TOKENS_EXPERTS=4800
CONTEXT_BLOCK_MAX_TOKENS_RELATIONSHIP_HINTS=2400
CONTEXT_USER_MAX_TOKENS=24000
CONTEXT_TRUNCATION_NOTICE=true

# -----------------------------------------------------------------------------
# Routing / Tracing
# -----------------------------------------------------------------------------
TRACE_ENABLED=true

# -----------------------------------------------------------------------------
# Relationship Graph Tuning
# -----------------------------------------------------------------------------
RELATIONSHIP_HINTS_MAX_EDGES=10
RELATIONSHIP_DECAY_LAMBDA=0.06
RELATIONSHIP_WEIGHT_K=0.2
RELATIONSHIP_CONFIDENCE_C=0.25

# -----------------------------------------------------------------------------
# Admin Access Control
# -----------------------------------------------------------------------------
ADMIN_ROLE_IDS=
ADMIN_USER_IDS=

# -----------------------------------------------------------------------------
# Timeouts (ms)
# -----------------------------------------------------------------------------
TIMEOUT_CHAT_MS=300000
TIMEOUT_MEMORY_MS=600000

# -----------------------------------------------------------------------------
# Context Budgeting Advanced
# -----------------------------------------------------------------------------
LLM_MODEL_LIMITS_JSON=""

# -----------------------------------------------------------------------------
# Doctor Utility
# -----------------------------------------------------------------------------
# Set to 1 to enable LLM ping in npm run doctor
LLM_DOCTOR_PING=0
